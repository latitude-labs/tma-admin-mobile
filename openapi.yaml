openapi: 3.1.0
info:
  title: TMA Admin API
  version: '1.0'
  description: |
    Temple Manchester Admin API provides endpoints for managing the martial arts school operations.

    ## Authentication
    Most endpoints require authentication using a bearer token obtained from the `/auth/login` endpoint.

    ## Mobile App Endpoints
    Endpoints under the authenticated group are designed for the mobile app used by coaches.
  contact:
    name: Temple Manchester Support
  license:
    name: Proprietary
servers:
  - url: http://localhost:8000/api
    description: Local development
  - url: https://admin-test.templemanchester.co.uk/api
    description: Test environment
  - url: https://admin.templemanchester.co.uk/api
    description: Production environment
paths:
  /auth/login:
    post:
      summary: Login
      description: Authenticate with email and password to receive a bearer token
      operationId: authLogin
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
                device_id:
                  type: string
                  description: Unique device identifier
                trust_token:
                  type: string
                  description: Trust token for trusted device
            example:
              email: user@example.com
              password: password123
      responses:
        '200':
          $ref: '#/components/responses/LoginSuccessResponse'
        '422':
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
                    properties:
                      email:
                        type: array
                        items:
                          type: string
              example:
                message: The provided credentials are incorrect.
                errors:
                  email:
                    - The provided credentials are incorrect.
  /auth/logout:
    post:
      summary: Logout
      description: Invalidate the current authentication token
      operationId: authLogout
      tags:
        - Authentication
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Successfully logged out
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: Successfully logged out
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /auth/user:
    get:
      summary: Get current user
      description: Get the authenticated user's details
      operationId: authUser
      tags:
        - Authentication
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Current user details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /admin/bookings:
    post:
      summary: Create bookings
      description: Create one or more bookings with optional mailing list subscription and traffic tracking
      tags:
        - Admin Bookings
      security:
        - AdminApiKey: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - bookings
              properties:
                bookings:
                  type: array
                  description: Array of bookings to create
                  items:
                    type: object
                    required:
                      - class_id
                      - datetime
                      - phone
                      - email
                      - names
                    properties:
                      class_id:
                        type: integer
                        description: ID of the class time
                        example: 1
                      datetime:
                        type: string
                        format: date-time
                        description: Date and time of the booking
                        example: '2024-03-15T10:00:00Z'
                      phone:
                        type: string
                        description: Contact phone number
                        example: '+447123456789'
                      email:
                        type: string
                        format: email
                        description: Contact email address
                        example: john.doe@example.com
                      names:
                        type: array
                        description: Names of attendees
                        items:
                          type: string
                        example:
                          - John Doe
                          - Jane Doe
                      whatsapp_reminder:
                        type: boolean
                        description: Whether to send WhatsApp reminders
                        default: false
                cadence_chat:
                  type: object
                  nullable: true
                  description: Cadence chat information if booking originated from chat
                  properties:
                    uuid:
                      type: string
                      description: Chat UUID
                      example: 550e8400-e29b-41d4-a716-446655440000
                    sender_name:
                      type: string
                      description: Name of the chat sender
                      example: John Smith
                mailing_list_opt_in:
                  type: boolean
                  description: Whether the user opted in to the mailing list
                  default: false
                contact_name:
                  type: string
                  nullable: true
                  description: Name of the contact for mailing list
                  example: John Doe
                referrer_type:
                  type: string
                  nullable: true
                  description: Type of traffic source/referrer
                  enum:
                    - GOOGLE_PAID
                    - GOOGLE_ORGANIC
                    - FACEBOOK_PAID
                    - FACEBOOK_ORGANIC
                    - INSTAGRAM_PAID
                    - INSTAGRAM_ORGANIC
                    - WEB_DIRECT
                  example: GOOGLE_PAID
      responses:
        '200':
          description: Bookings created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  bookings:
                    type: array
                    items:
                      $ref: '#/components/schemas/Booking'
                  message:
                    type: string
                    example: Bookings created.
        '400':
          description: Bad request - validation error or booking creation failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to create booking with the scheduling system
        '401':
          description: Unauthorized - Invalid or missing API key
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized
  /auth/2fa/status:
    get:
      summary: Get 2FA status
      description: Get the current 2FA status for the authenticated user
      operationId: get2FAStatus
      tags:
        - Authentication
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 2FA status retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
                    description: Whether 2FA is enabled for the user
                  methods:
                    type: array
                    items:
                      type: string
                      enum:
                        - otp
                        - biometric
                    description: Available 2FA methods
                  biometric_enrolled:
                    type: boolean
                    description: Whether biometric authentication is enrolled
                  trusted_devices:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: Device ID
                        name:
                          type: string
                          description: Device name
                        last_used:
                          type: string
                          format: date-time
                          description: Last time device was used
                        created_at:
                          type: string
                          format: date-time
                          description: When device was registered
                        is_current:
                          type: boolean
                          description: Whether this is the current device
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /auth/2fa/setup:
    post:
      summary: Setup 2FA
      description: Initialize 2FA setup for the authenticated user
      operationId: setup2FA
      tags:
        - Authentication
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - method
              properties:
                method:
                  type: string
                  enum:
                    - otp
                  description: The 2FA method to setup
      responses:
        '200':
          description: 2FA setup initiated
          content:
            application/json:
              schema:
                type: object
                properties:
                  secret:
                    type: string
                    description: TOTP secret key
                  qr_code:
                    type: string
                    description: QR code URL for authenticator apps
                  backup_codes:
                    type: array
                    items:
                      type: string
                    description: Backup recovery codes
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '422':
          description: 2FA already enabled
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 2FA is already enabled
  /auth/2fa/send:
    post:
      summary: Send OTP code
      description: Send a one-time password code to the user's registered email
      operationId: sendOtpCode
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                phone_number:
                  type: string
                  description: User's phone number (preferred)
                email:
                  type: string
                  format: email
                  description: User's email address (alternative to phone_number)
      responses:
        '200':
          description: OTP code sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  sent:
                    type: boolean
                    description: Whether the OTP was sent
                  message:
                    type: string
                    description: Status message
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          description: Too many requests - rate limited
          content:
            application/json:
              schema:
                type: object
                properties:
                  sent:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Too many attempts. Please try again later.
  /auth/2fa/verify:
    post:
      summary: Verify 2FA code
      description: Verify a 2FA code (OTP, biometric, or recovery code) and complete authentication
      operationId: verify2FA
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - method
                - device_id
                - temp_token
              properties:
                method:
                  type: string
                  enum:
                    - otp
                    - biometric
                    - recovery
                  description: The 2FA method being used
                code:
                  type: string
                  description: OTP or recovery code (required for otp/recovery methods)
                biometric_token:
                  type: string
                  description: Biometric authentication token (required for biometric method)
                device_id:
                  type: string
                  description: Unique device identifier
                trust_device:
                  type: boolean
                  description: Whether to trust this device for 30 days
                  default: false
                temp_token:
                  type: string
                  description: Temporary token from initial login
      responses:
        '200':
          description: 2FA verification successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  token:
                    type: string
                    description: Authentication token
                  expires_at:
                    type: string
                    format: date-time
                    description: Token expiration time
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      name:
                        type: string
                      email:
                        type: string
                      is_admin:
                        type: boolean
                  trust_token:
                    type: string
                    description: Trust token for device (if trust_device was true)
        '422':
          description: Invalid verification code
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
  /auth/2fa/biometric/register:
    post:
      summary: Register biometric device
      description: Register a device for biometric authentication
      operationId: registerBiometric
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
                - device_id
              properties:
                user_id:
                  type: integer
                  description: User ID
                device_id:
                  type: string
                  description: Unique device identifier
                device_name:
                  type: string
                  description: Device name (e.g., "iPhone 14 Pro")
      responses:
        '200':
          description: Device registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: Unique biometric token for the device
        '403':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized
        '422':
          $ref: '#/components/responses/ValidationError'
  /auth/2fa/disable:
    delete:
      summary: Disable 2FA
      description: Disable 2FA for the authenticated user
      operationId: disable2FA
      tags:
        - Authentication
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - verification_code
              properties:
                verification_code:
                  type: string
                  description: OTP code or user password for verification
      responses:
        '200':
          description: 2FA disabled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  disabled:
                    type: boolean
                    example: true
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '422':
          description: Invalid verification code
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
  /cadence/bookings/by-club:
    get:
      summary: Get bookings aggregated by club
      description: |
        Returns booking statistics aggregated by club with optional filtering by date range and channel types.
        Includes total bookings, active bookings, cancelled bookings, no-show bookings, and calculated rates.
      operationId: getCadenceBookingsByClub
      tags:
        - Cadence
      parameters:
        - name: from_date
          in: query
          description: Filter bookings from this date (start of day)
          required: false
          schema:
            type: string
            format: date
          example: '2025-01-01'
        - name: to_date
          in: query
          description: Filter bookings until this date (end of day)
          required: false
          schema:
            type: string
            format: date
          example: '2025-01-31'
        - name: channel_types
          in: query
          description: Filter bookings by specific channel types
          required: false
          schema:
            type: array
            items:
              type: string
          style: form
          explode: true
          example:
            - whatsapp
            - email
            - phone
      responses:
        '200':
          description: Bookings aggregated by club successfully retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        club_id:
                          type: integer
                          description: The ID of the club
                        club_name:
                          type: string
                          description: The name of the club
                        total_bookings:
                          type: integer
                          description: Total number of bookings for the club
                        active_bookings:
                          type: integer
                          description: Number of active bookings (not cancelled and not no-show)
                        cancelled_bookings:
                          type: integer
                          description: Number of cancelled bookings
                        no_show_bookings:
                          type: integer
                          description: Number of no-show bookings
                        attendance_rate:
                          type: number
                          format: float
                          description: Percentage of active bookings that attended (active - no_shows) / active * 100
                        cancellation_rate:
                          type: number
                          format: float
                          description: Percentage of bookings that were cancelled (cancelled / total * 100)
              example:
                data:
                  - club_id: 1
                    club_name: Temple Manchester - City Center
                    total_bookings: 150
                    active_bookings: 120
                    cancelled_bookings: 25
                    no_show_bookings: 5
                    attendance_rate: 95.8
                    cancellation_rate: 16.7
                  - club_id: 2
                    club_name: Temple Manchester - South
                    total_bookings: 200
                    active_bookings: 160
                    cancelled_bookings: 30
                    no_show_bookings: 10
                    attendance_rate: 93.8
                    cancellation_rate: 15
        '422':
          $ref: '#/components/responses/ValidationError'
  /clubs:
    get:
      summary: Get clubs assigned to user
      description: |
        Returns a list of clubs assigned to the authenticated user through their classTimes relation.
        Admin users (is_admin=true) will receive all clubs in the system.

        When include_all=true is set, returns all clubs in the system regardless of user access,
        using the ClubLiteResource format (limited information without class times).
      operationId: getMobileClubs
      tags:
        - Mobile App
      security:
        - BearerAuth: []
      parameters:
        - name: include_all
          in: query
          description: When true, returns all clubs regardless of user access using ClubLiteResource format
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: List of clubs successfully retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/Club'
                        - $ref: '#/components/schemas/ClubLite'
                    description: Returns Club schema normally, or ClubLite when include_all=true
              example:
                data:
                  - id: 1
                    name: Temple Manchester - City Center
                    slug: city-center
                    address: 123 Main St
                    postcode: M1 1AA
                    latitude: 53.4808
                    longitude: -2.2426
                    class_times:
                      - id: 1
                        club_id: 1
                        day: Monday
                        name: Kids 1
                        start_time: '17:00:00'
                        end_time: '18:00:00'
                        coaches: John Smith, Jane Doe
                        todays_booking_count: 12
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /clubs-count:
    get:
      summary: Get clubs count
      description: |
        Retrieve the total count of clubs accessible to the authenticated user.
        - Admins can see the count of all clubs
        - Non-admin users only see the count of clubs associated with their assigned class times
      operationId: getClubsCount
      tags:
        - Mobile App
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Count of clubs
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        description: Total number of accessible clubs
                        example: 5
                    required:
                      - count
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /class-times:
    get:
      summary: Get class times
      description: |
        Retrieve class times from the database with optional filtering.
        - Admins can see all class times
        - Non-admin users only see class times they are assigned to
      operationId: getClassTimes
      tags:
        - Mobile App
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: date_from
          schema:
            type: string
            format: date
          description: Filter class times from this date (inclusive)
          example: '2024-01-01'
        - in: query
          name: date_to
          schema:
            type: string
            format: date
          description: Filter class times to this date (inclusive). Must be after or equal to date_from
          example: '2024-12-31'
        - in: query
          name: club_id
          schema:
            type: integer
          description: Filter by specific club ID
          example: 1
      responses:
        '200':
          description: List of class times
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        club_id:
                          type: integer
                          example: 1
                        day:
                          type: string
                          example: Monday
                          description: Day of the week
                        name:
                          type: string
                          example: Morning Class
                          description: Name of the class
                        start_time:
                          type: string
                          format: time
                          example: '09:00:00'
                        end_time:
                          type: string
                          format: time
                          example: '10:30:00'
                        club:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 1
                            name:
                              type: string
                              example: Downtown Club
                            address:
                              type: string
                              example: 123 Main St
                            city:
                              type: string
                              example: New York
                            county:
                              type: string
                              example: New York County
                            postcode:
                              type: string
                              example: '10001'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '422':
          $ref: '#/components/responses/ValidationError'
  /class-times/{id}/bookings:
    get:
      summary: Get bookings for a class time on a specific date
      description: Returns all bookings for a specific class time on a given date. Coaches can only see bookings for their assigned class times.
      operationId: getClassTimeBookings
      tags:
        - Class Times
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the class time
          schema:
            type: integer
        - name: date
          in: query
          required: true
          description: Date to get bookings for (YYYY-MM-DD format)
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Bookings retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Booking'
        '403':
          description: Unauthorized - User doesn't have permission for this class time
        '404':
          description: Class time not found
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
  /facebook-pages:
    get:
      tags:
        - Mobile App
        - Cadence Proxy
      summary: Get Facebook pages
      description: |
        Retrieve Facebook pages from Cadence API. This is a proxy endpoint that forwards
        the request to Cadence and returns the response as-is. Only accessible by admin users.
      operationId: getFacebookPages
      security:
        - BearerAuth: []
      parameters:
        - name: search
          in: query
          description: Optional search term to filter Facebook pages by name
          required: false
          schema:
            type: string
            maxLength: 255
          example: Didsbury
      responses:
        '200':
          description: Successful response from Cadence API
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Unique identifier for the Facebook page
                        uuid:
                          type: string
                          format: uuid
                          description: Universal unique identifier for cross-system coordination
                        name:
                          type: string
                          description: Name of the Facebook page
                        facebook_page_id:
                          type: string
                          description: Facebook's internal page ID
                        organisation_id:
                          type: integer
                          description: ID of the organisation that owns this page
                        status:
                          type: string
                          enum:
                            - active
                            - inactive
                            - error
                          description: Current status of the page
                        url:
                          type: string
                          format: uri
                          description: URL to the Facebook page
                        last_synced_at:
                          type: string
                          format: date-time
                          nullable: true
                          description: Last time the page was synced with Facebook
                        clubs:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: integer
                              name:
                                type: string
                          description: Associated clubs (only included when loaded)
              example:
                data:
                  - id: 1
                    uuid: 550e8400-e29b-41d4-a716-446655440000
                    name: Didsbury Martial Arts
                    facebook_page_id: '123456789'
                    organisation_id: 1
                    status: active
                    url: https://facebook.com/didsburyma
                    last_synced_at: '2024-01-15T10:30:00Z'
                    clubs:
                      - id: 1
                        name: Didsbury Club
        '403':
          description: Forbidden - User is not an admin
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Admin access required.
        '500':
          description: Server error - Failed to fetch from Cadence API
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to fetch Facebook pages
                  error:
                    type: string
                    description: Detailed error message from Cadence service
  /advertising/metrics:
    get:
      tags:
        - Mobile App
        - Cadence Proxy
      summary: Get advertising metrics summary
      description: |
        Retrieve advertising metrics summary from Cadence API for a specified date range with optional
        Facebook page filtering. Returns only the summary data with total spend, total bookings,
        and cost per booking. Only accessible by admin users.
      operationId: getAdvertisingMetrics
      security:
        - BearerAuth: []
      parameters:
        - name: start_date
          in: query
          description: Start date for metrics (YYYY-MM-DD format)
          required: true
          schema:
            type: string
            format: date
          example: '2024-01-01'
        - name: end_date
          in: query
          description: End date for metrics (YYYY-MM-DD format)
          required: true
          schema:
            type: string
            format: date
          example: '2024-01-31'
        - name: facebook_page_uuids
          in: query
          description: Array of Facebook page UUIDs to filter by
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              format: uuid
          example:
            - 550e8400-e29b-41d4-a716-446655440000
            - 550e8400-e29b-41d4-a716-446655440001
      responses:
        '200':
          description: Successful response with advertising metrics summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_spend:
                    type: number
                    format: float
                    description: Total advertising spend for the period
                  total_bookings:
                    type: integer
                    description: Total number of bookings generated
                  cost_per_booking:
                    type: number
                    format: float
                    nullable: true
                    description: Average cost per booking (null if no bookings)
                  club_bookings:
                    type: array
                    description: Booking breakdown by club
                    items:
                      type: object
                      properties:
                        club_id:
                          type: integer
                          nullable: true
                          description: ID of the club
                        club_name:
                          type: string
                          description: Name of the club
                        bookings:
                          type: integer
                          description: Number of bookings for this club
              example:
                total_spend: 150
                total_bookings: 25
                cost_per_booking: 6
                club_bookings:
                  - club_id: 1
                    club_name: Temple Manchester
                    bookings: 15
                  - club_id: 2
                    club_name: Temple Liverpool
                    bookings: 10
        '403':
          description: Forbidden - User is not an admin
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Admin access required.
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
                    additionalProperties:
                      type: array
                      items:
                        type: string
              example:
                message: The given data was invalid.
                errors:
                  start_date:
                    - The start date field is required.
                  end_date:
                    - The end date must be a date after or equal to start date.
        '500':
          description: Server error - Failed to fetch from Cadence API
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to fetch advertising metrics
                  error:
                    type: string
                    description: Detailed error message from Cadence service
  /advertising/metrics/batch:
    post:
      tags:
        - Mobile App
      summary: Get advertising metrics for multiple Facebook pages in batch
      description: Fetches advertising metrics for multiple Facebook page configurations in a single request. Admin access required.
      operationId: getAdvertisingMetricsBatch
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - requests
              properties:
                requests:
                  type: array
                  description: Array of metric requests to process
                  minItems: 1
                  maxItems: 50
                  items:
                    type: object
                    required:
                      - page_uuids
                      - start_date
                      - end_date
                    properties:
                      page_uuids:
                        type: array
                        description: Array of Facebook page UUIDs
                        minItems: 1
                        items:
                          type: string
                          format: uuid
                      start_date:
                        type: string
                        format: date
                        description: Start date for metrics in YYYY-MM-DD format
                        example: '2024-01-01'
                      end_date:
                        type: string
                        format: date
                        description: End date for metrics in YYYY-MM-DD format
                        example: '2024-01-31'
            examples:
              batch_request:
                summary: Batch request for multiple pages
                value:
                  requests:
                    - page_uuids:
                        - 550e8400-e29b-41d4-a716-446655440001
                      start_date: '2024-01-01'
                      end_date: '2024-01-31'
                    - page_uuids:
                        - 550e8400-e29b-41d4-a716-446655440002
                        - 550e8400-e29b-41d4-a716-446655440003
                      start_date: '2024-01-01'
                      end_date: '2024-01-31'
      responses:
        '200':
          description: Successfully retrieved metrics for all requested pages
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        page_uuids:
                          type: array
                          items:
                            type: string
                            format: uuid
                        start_date:
                          type: string
                          format: date
                        end_date:
                          type: string
                          format: date
                        metrics:
                          type: object
                          properties:
                            total_spend:
                              type: number
                              format: float
                              description: Total advertising spend in the period
                            total_bookings:
                              type: integer
                              description: Total number of bookings from Facebook/Instagram
                            cost_per_booking:
                              type: number
                              format: float
                              nullable: true
                              description: Average cost per booking
                            club_bookings:
                              type: array
                              items:
                                type: object
                                properties:
                                  club_id:
                                    type: integer
                                    nullable: true
                                  club_name:
                                    type: string
                                  bookings:
                                    type: integer
                  errors:
                    type: array
                    nullable: true
                    description: Array of errors for failed requests
                    items:
                      type: object
                      properties:
                        index:
                          type: integer
                          description: Index of the failed request
                        page_uuids:
                          type: array
                          items:
                            type: string
                            format: uuid
                        error:
                          type: string
                          description: Error message
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden - Admin access required
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Admin access required.
        '422':
          $ref: '#/components/responses/ValidationError'
  /bookings:
    get:
      summary: List bookings
      description: Returns a paginated list of bookings with optional filters
      operationId: listBookings
      tags:
        - Bookings
      security:
        - bearerAuth: []
      parameters:
        - name: start_date
          in: query
          required: false
          description: Filter bookings starting from this date
          schema:
            type: string
            format: date
        - name: end_date
          in: query
          required: false
          description: Filter bookings up to this date
          schema:
            type: string
            format: date
        - name: per_page
          in: query
          required: false
          description: Number of items per page (max 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: club_id
          in: query
          required: false
          description: Filter by specific club ID
          schema:
            type: integer
        - name: class_time_id
          in: query
          required: false
          description: Filter by specific class time ID
          schema:
            type: integer
        - name: status
          in: query
          required: false
          description: Filter by booking status
          schema:
            type: string
            enum:
              - pending
              - paid_dd
              - paid_awaiting_dd
              - unpaid_dd
              - unpaid_coach_call
              - not_joining
        - name: view_mode
          in: query
          required: false
          description: Controls which bookings are visible - 'mine' for bookings the authenticated user has access to (default), 'all' for all bookings across all clubs/locations
          schema:
            type: string
            enum:
              - mine
              - all
            default: mine
      responses:
        '200':
          description: Bookings retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Booking'
                  links:
                    type: object
                    properties:
                      first:
                        type: string
                      last:
                        type: string
                      prev:
                        type: string
                        nullable: true
                      next:
                        type: string
                        nullable: true
                  meta:
                    type: object
                    properties:
                      current_page:
                        type: integer
                      from:
                        type: integer
                      last_page:
                        type: integer
                      path:
                        type: string
                      per_page:
                        type: integer
                      to:
                        type: integer
                      total:
                        type: integer
        '401':
          description: Unauthorized - Invalid or missing token
        '422':
          description: Validation error
  /bookings/sync:
    get:
      tags:
        - Bookings
      summary: Sync bookings incrementally
      description: Get incremental changes (new, updated, deleted) for bookings since last sync timestamp
      operationId: syncBookings
      security:
        - bearerAuth: []
      parameters:
        - name: since
          in: query
          required: true
          description: ISO 8601 timestamp to get changes since
          schema:
            type: string
            format: date-time
            example: '2024-01-01T00:00:00'
        - name: page_size
          in: query
          required: false
          description: Number of records to return per page
          schema:
            type: integer
            minimum: 10
            maximum: 500
            default: 100
        - name: cursor
          in: query
          required: false
          description: Cursor for pagination (returned from previous response)
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved sync data
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      updated:
                        type: array
                        description: Array of new or updated bookings
                        items:
                          $ref: '#/components/schemas/Booking'
                      deleted:
                        type: array
                        description: Array of IDs for deleted bookings
                        items:
                          type: integer
                  meta:
                    type: object
                    properties:
                      sync_timestamp:
                        type: string
                        format: date-time
                        description: Current server timestamp for next sync
                      has_more:
                        type: boolean
                        description: Whether there are more records to sync
                      next_cursor:
                        type: string
                        nullable: true
                        description: Cursor for fetching next page of results
                      counts:
                        type: object
                        properties:
                          updated:
                            type: integer
                            description: Number of updated records in this response
                          deleted:
                            type: integer
                            description: Number of deleted records in this response
              examples:
                sync_response:
                  summary: Example sync response
                  value:
                    data:
                      updated:
                        - id: 1234
                          uuid: 550e8400-e29b-41d4-a716-446655440000
                          student_name: John Doe
                          start_time: '2024-01-15T10:00:00'
                          status: scheduled
                          updated_at: '2024-01-10T14:30:00'
                      deleted:
                        - 1001
                        - 1002
                    meta:
                      sync_timestamp: '2024-01-10T15:00:00'
                      has_more: true
                      next_cursor: MjAyNC0wMS0xMFQxNDozMDowMHwxMjM0
                      counts:
                        updated: 1
                        deleted: 2
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/ValidationError'
  /bookings/totals:
    get:
      summary: Get booking totals
      description: |
        Retrieve aggregated booking counts.
        - Admins can see totals for all bookings
        - Non-admin users only see totals for bookings in their assigned class times by default
        - Non-admin users can set view_mode=all to see totals for all bookings across all clubs
      operationId: getBookingsTotals
      tags:
        - Mobile App
      security:
        - BearerAuth: []
      parameters:
        - name: view_mode
          in: query
          required: false
          description: Controls which bookings are included in totals - 'mine' for bookings the authenticated user has access to (default), 'all' for all bookings across all clubs/locations
          schema:
            type: string
            enum:
              - mine
              - all
            default: mine
      responses:
        '200':
          description: Booking totals
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      today:
                        type: integer
                        description: Number of bookings for today
                        example: 12
                      month:
                        type: integer
                        description: Number of bookings for the current month
                        example: 145
                      upcoming:
                        type: integer
                        description: Number of future bookings from now
                        example: 67
                    required:
                      - today
                      - month
                      - upcoming
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /bookings/stats:
    get:
      summary: Get booking statistics
      description: Returns statistical information about bookings including conversion rates
      operationId: getBookingStatistics
      tags:
        - Bookings
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          required: false
          description: Filter statistics by specific status
          schema:
            type: string
            enum:
              - pending
              - paid_dd
              - paid_awaiting_dd
              - unpaid_dd
              - unpaid_coach_call
              - not_joining
      responses:
        '200':
          description: Booking statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BookingStatistics'
        '401':
          description: Unauthorized - Invalid or missing token
  /bookings/{booking_id}/status:
    put:
      summary: Update booking attendance status
      description: Updates the attendance status of a booking (completed, no-show, cancelled, or scheduled). This endpoint is used for tracking attendance at trial classes.
      operationId: updateBookingAttendanceStatus
      tags:
        - Bookings
      security:
        - bearerAuth: []
      parameters:
        - name: booking_id
          in: path
          required: true
          description: ID of the booking to update
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum:
                    - completed
                    - no-show
                    - cancelled
                    - scheduled
                  description: |
                    New attendance status for the booking:
                    - `completed`: Student attended and completed the trial (checked in)
                    - `no-show`: Student did not attend without notice
                    - `cancelled`: Booking was cancelled
                    - `scheduled`: Reset to scheduled state (removes all attendance marks)
            examples:
              checkIn:
                summary: Mark as completed/checked in
                value:
                  status: completed
              markNoShow:
                summary: Mark as no-show
                value:
                  status: no-show
              cancel:
                summary: Mark as cancelled
                value:
                  status: cancelled
              resetToScheduled:
                summary: Reset to scheduled
                value:
                  status: scheduled
      responses:
        '200':
          description: Attendance status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Booking status updated successfully
                  booking:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 123
                      uuid:
                        type: string
                        example: 550e8400-e29b-41d4-a716-446655440000
                      names:
                        type: string
                        example: John Doe
                      email:
                        type: string
                        example: john@example.com
                      phone:
                        type: string
                        example: '+447123456789'
                      attendance_status:
                        type: string
                        example: completed
                        enum:
                          - completed
                          - no-show
                          - cancelled
                          - scheduled
                      checked_in_at:
                        type: string
                        format: date-time
                        nullable: true
                        example: '2025-01-20T10:30:00Z'
                      no_show_at:
                        type: string
                        format: date-time
                        nullable: true
                        example: null
                      cancelled_at:
                        type: string
                        format: date-time
                        nullable: true
                        example: null
                      no_show:
                        type: boolean
                        example: false
                      start_time:
                        type: string
                        format: date-time
                        example: '2025-01-20T10:00:00Z'
                      class_time:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          day_of_week:
                            type: string
                            example: Monday
                          time:
                            type: string
                            example: '10:00'
                          club:
                            type: object
                            properties:
                              id:
                                type: integer
                                example: 1
                              name:
                                type: string
                                example: Temple Kung Fu - Leeds
                      kit_orders:
                        type: array
                        items:
                          $ref: '#/components/schemas/KitOrder'
                      reminders:
                        type: array
                        items:
                          $ref: '#/components/schemas/Reminder'
        '403':
          description: Unauthorized - User doesn't have permission to update this booking
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '404':
          description: Booking not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Booking not found
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The given data was invalid.
                  errors:
                    type: object
                    properties:
                      status:
                        type: array
                        items:
                          type: string
                        example:
                          - The selected status is invalid.
        '500':
          description: Failed to update booking status
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to update booking status
                  details:
                    type: string
                    example: Database transaction failed
  /bookings/{booking_id}/conversion-status:
    put:
      summary: Update booking status
      description: Updates the status of a booking and optionally creates kit orders and reminders
      operationId: updateBookingStatus
      tags:
        - Bookings
      security:
        - bearerAuth: []
      parameters:
        - name: booking_id
          in: path
          required: true
          description: ID of the booking to update
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum:
                    - pending
                    - paid_dd
                    - paid_awaiting_dd
                    - unpaid_dd
                    - unpaid_coach_call
                    - not_joining
                  description: New status for the booking
                kit_items:
                  type: array
                  items:
                    type: object
                    properties:
                      type:
                        type: string
                        example: tshirt
                      size:
                        type: string
                        example: medium youth
                  description: Optional kit items to order
                reminder_time:
                  type: string
                  format: date-time
                  example: '2025-01-20T10:00:00Z'
                  description: Optional reminder time
      responses:
        '200':
          description: Status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Status updated
                  booking:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 123
                      status:
                        type: string
                        example: paid_dd
                      kit_order_id:
                        type: integer
                        nullable: true
                        example: 456
                      reminder_id:
                        type: integer
                        nullable: true
                        example: 789
        '403':
          description: Unauthorized - User doesn't have permission to update this booking
        '404':
          description: Booking not found
        '422':
          description: Validation error
        '500':
          description: Failed to update booking status
  /kit-catalog:
    get:
      summary: Get kit catalog
      description: Returns available kit items for ordering
      operationId: getKitCatalog
      tags:
        - Kit
      security:
        - bearer_auth: []
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Kit'
              example:
                items:
                  - id: 1
                    type: tshirt
                    name: T-Shirt
                    sizes:
                      - Small Youth
                      - Medium Youth
                      - Large Youth
                      - XL Youth
                      - Small
                      - Medium
                      - Large
                      - XL
                      - 2XL
                      - 3XL
                    price: 25
                    description: Temple Manchester training t-shirt
                    image_url: https://s3.amazonaws.com/your-bucket/kit-images/tshirt.jpg
                  - id: 2
                    type: trousers
                    name: Trousers
                    sizes:
                      - Small Youth
                      - Medium Youth
                      - Large Youth
                      - XL Youth
                      - Small
                      - Medium
                      - Large
                      - XL
                      - 2XL
                      - 3XL
                    price: 30
                    description: Temple Manchester training trousers
                  - id: 3
                    type: gloves
                    name: Gloves
                    sizes:
                      - 8oz
                      - 10oz
                      - 12oz
                      - 14oz
                      - 16oz
                    price: 35
                    description: Boxing gloves for training and sparring
                  - id: 4
                    type: shinpads
                    name: Shin Pads
                    sizes:
                      - Small
                      - Medium
                      - Large
                      - XL
                    price: 15
                    description: Protective shin pads for sparring
                  - id: 5
                    type: kitbag
                    name: Kit Bag
                    sizes:
                      - One Size
                    price: 40
                    description: Temple Manchester sports bag for all your training gear
        '401':
          $ref: '#/components/responses/Unauthorized'
  /kit-orders:
    get:
      summary: List kit orders
      description: Returns a paginated list of all kit orders with optional search
      operationId: listKitOrders
      tags:
        - Kit Orders
      security:
        - bearerAuth: []
      parameters:
        - name: per_page
          in: query
          required: false
          description: Number of items per page (max 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: search
          in: query
          required: false
          description: Search by student name or booking name
          schema:
            type: string
      responses:
        '200':
          description: Kit orders retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/KitOrder'
        '401':
          description: Unauthorized - Invalid or missing token
    post:
      summary: Create kit order
      description: Creates a new kit order either for a booking or standalone with student name
      operationId: createKitOrder
      tags:
        - Kit Orders
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - items
              properties:
                booking_id:
                  type: integer
                  nullable: true
                  example: 123
                  description: Optional booking ID to link the kit order to
                student_name:
                  type: string
                  example: John Smith
                  description: Student name (required if no booking_id)
                contact_email:
                  type: string
                  format: email
                  example: john@example.com
                  description: Contact email for standalone orders
                contact_phone:
                  type: string
                  example: '+447900123456'
                  description: Contact phone for standalone orders
                items:
                  type: array
                  items:
                    type: object
                    required:
                      - type
                      - size
                    properties:
                      type:
                        type: string
                        example: tshirt
                      size:
                        type: string
                        example: medium youth
                notes:
                  type: string
                  example: Please order extra large for growth
                  description: Optional notes about the order
      responses:
        '201':
          description: Kit order created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KitOrder'
        '403':
          description: Unauthorized - User doesn't have permission for this booking
        '404':
          description: Booking not found
        '422':
          description: Validation error
  /kit-orders/{id}:
    get:
      summary: Get kit order
      description: Returns a specific kit order by ID
      operationId: getKitOrder
      tags:
        - Kit Orders
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the kit order to retrieve
          schema:
            type: integer
      responses:
        '200':
          description: Kit order retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KitOrder'
        '403':
          description: Unauthorized - User doesn't have permission for this kit order
        '404':
          description: Kit order not found
  /bookings/{booking_id}/kit-orders:
    get:
      summary: Get kit orders for booking
      description: Returns all kit orders associated with a specific booking
      operationId: getKitOrdersForBooking
      tags:
        - Kit Orders
      security:
        - bearerAuth: []
      parameters:
        - name: booking_id
          in: path
          required: true
          description: ID of the booking to get kit orders for
          schema:
            type: integer
      responses:
        '200':
          description: Kit orders retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KitOrder'
        '403':
          description: Unauthorized - User doesn't have permission for this booking
        '404':
          description: Booking not found
  /reminders:
    post:
      summary: Create reminder
      description: Creates a new reminder. Admins can create reminders for any user, while coaches can only create reminders for themselves.
      operationId: createReminder
      tags:
        - Reminders
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - reminder_time
              properties:
                title:
                  type: string
                  example: Call John about trial
                description:
                  type: string
                  nullable: true
                  example: 'Phone: 0411 123 456'
                reminder_time:
                  type: string
                  format: date-time
                  example: '2025-01-20T10:00:00Z'
                priority:
                  type: string
                  enum:
                    - low
                    - medium
                    - high
                    - urgent
                  default: medium
                  example: high
                booking_id:
                  type: integer
                  nullable: true
                  example: 123
                user_id:
                  type: integer
                  nullable: true
                  description: Only admins can set this field to create reminders for other users
                  example: 5
      responses:
        '201':
          description: Reminder created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reminder'
        '403':
          description: Unauthorized - Only admins can create reminders for other users
        '422':
          description: Validation error
  /reminders/dashboard:
    get:
      summary: Get dashboard reminders
      description: Returns user's upcoming reminders sorted by time, along with count statistics
      operationId: getDashboardReminders
      tags:
        - Reminders
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Dashboard reminders retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  reminders:
                    type: array
                    items:
                      $ref: '#/components/schemas/Reminder'
                  stats:
                    type: object
                    properties:
                      overdue:
                        type: integer
                        example: 2
                      today:
                        type: integer
                        example: 5
                      upcoming:
                        type: integer
                        example: 12
        '401':
          description: Unauthorized
  /reminders/my:
    get:
      summary: Get my reminders
      description: Returns all reminders for the current user with optional filtering
      operationId: getMyReminders
      tags:
        - Reminders
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum:
              - pending
              - completed
              - snoozed
              - cancelled
          description: Filter by reminder status
        - in: query
          name: priority
          schema:
            type: string
            enum:
              - low
              - medium
              - high
              - urgent
          description: Filter by priority
        - in: query
          name: sort
          schema:
            type: string
            default: reminder_time
          description: Field to sort by
        - in: query
          name: direction
          schema:
            type: string
            enum:
              - asc
              - desc
            default: asc
          description: Sort direction
        - in: query
          name: per_page
          schema:
            type: integer
            default: 20
          description: Number of items per page
      responses:
        '200':
          description: Reminders retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Reminder'
                  meta:
                    type: object
                    properties:
                      current_page:
                        type: integer
                      total:
                        type: integer
                      per_page:
                        type: integer
                  links:
                    type: object
                    properties:
                      first:
                        type: string
                      last:
                        type: string
                      next:
                        type: string
                        nullable: true
                      prev:
                        type: string
                        nullable: true
        '401':
          description: Unauthorized
  /reminders/{id}:
    put:
      summary: Update reminder
      description: Update an existing reminder's details
      operationId: updateReminder
      tags:
        - Reminders
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: Reminder ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: 'Updated: Call John about trial'
                description:
                  type: string
                  nullable: true
                  example: 'Updated phone number: 0412 345 678'
                reminder_time:
                  type: string
                  format: date-time
                  example: '2025-01-21T14:00:00Z'
                priority:
                  type: string
                  enum:
                    - low
                    - medium
                    - high
                    - urgent
                  example: urgent
                status:
                  type: string
                  enum:
                    - pending
                    - completed
                    - snoozed
                    - cancelled
                  example: snoozed
                snooze_until:
                  type: string
                  format: date-time
                  nullable: true
                  description: Required when status is set to 'snoozed'
                  example: '2025-01-21T16:00:00Z'
      responses:
        '200':
          description: Reminder updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reminder'
        '403':
          description: Unauthorized - Reminder belongs to another user
        '404':
          description: Reminder not found
        '422':
          description: Validation error (e.g., snooze_until required when status is snoozed)
    delete:
      summary: Delete reminder
      description: Delete a reminder permanently
      operationId: deleteReminder
      tags:
        - Reminders
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: Reminder ID
      responses:
        '200':
          description: Reminder deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Reminder deleted successfully
        '403':
          description: Unauthorized - Reminder belongs to another user
        '404':
          description: Reminder not found
  /reminders/{id}/complete:
    put:
      summary: Complete reminder
      description: Marks a reminder as completed
      operationId: completeReminder
      tags:
        - Reminders
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the reminder to complete
          schema:
            type: integer
      responses:
        '200':
          description: Reminder marked as completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Reminder marked as completed
                  reminder:
                    $ref: '#/components/schemas/Reminder'
        '403':
          description: Unauthorized - User doesn't have permission for this reminder
        '404':
          description: Reminder not found
  /reminders/bulk-complete:
    post:
      summary: Bulk complete reminders
      description: Mark multiple reminders as completed at once
      operationId: bulkCompleteReminders
      tags:
        - Reminders
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - reminder_ids
              properties:
                reminder_ids:
                  type: array
                  items:
                    type: integer
                  example:
                    - 1
                    - 2
                    - 3
                    - 5
      responses:
        '200':
          description: Reminders marked as completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 4 reminders marked as completed
                  reminders:
                    type: array
                    items:
                      $ref: '#/components/schemas/Reminder'
        '403':
          description: Some reminders not found or unauthorized
        '422':
          description: Validation error
  /reminders/bulk-snooze:
    post:
      summary: Bulk snooze reminders
      description: Snooze multiple reminders at once until a specified time
      operationId: bulkSnoozeReminders
      tags:
        - Reminders
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - reminder_ids
                - snooze_until
              properties:
                reminder_ids:
                  type: array
                  items:
                    type: integer
                  example:
                    - 1
                    - 2
                    - 3
                    - 5
                snooze_until:
                  type: string
                  format: date-time
                  example: '2025-01-21T16:00:00Z'
      responses:
        '200':
          description: Reminders snoozed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 4 reminders snoozed until 2025-01-21T16:00:00Z
                  reminders:
                    type: array
                    items:
                      $ref: '#/components/schemas/Reminder'
        '403':
          description: Some reminders not found or unauthorized
        '422':
          description: Validation error
  /end-of-day-reports:
    get:
      summary: List End of Day reports
      operationId: listEndOfDayReports
      tags:
        - End of Day Reports
      security:
        - BearerAuth: []
      parameters:
        - name: club_id
          in: query
          schema:
            type: integer
          description: ID of the club to get EoD reports for
        - name: user_id
          in: query
          schema:
            type: integer
          description: ID of the user to get EoD reports for (admin only)
        - name: date_from
          in: query
          schema:
            type: string
            format: date
        - name: date_to
          in: query
          schema:
            type: string
            format: date
        - name: page
          in: query
          schema:
            type: integer
          description: Page number
        - name: per_page
          in: query
          schema:
            type: integer
          description: Items per page
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EndOfDayReport'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      summary: Create End of Day report
      operationId: storeEndOfDayReport
      tags:
        - End of Day Reports
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - club_id
                - report_date
                - kids_1_count
                - kids_2_count
                - adults_count
                - kids_1_trials
                - kids_2_trials
                - adults_trials
                - new_kids_paid_kit_and_signed_dd_count
                - new_kids_signed_dd_no_kit_count
                - new_adults_paid_kit_and_signed_dd_count
                - new_adults_signed_dd_no_kit_count
                - returning_kids_paid_kit_and_signed_dd_count
                - returning_kids_signed_dd_no_kit_count
                - returning_adults_paid_kit_and_signed_dd_count
                - returning_adults_signed_dd_no_kit_count
                - total_cash_taken
              properties:
                club_id:
                  type: integer
                  description: ID of the club this report is for
                report_date:
                  type: string
                  format: date
                  description: Date of the report
                kids_1_count:
                  type: integer
                  minimum: 0
                  description: Number of kids in group 1
                kids_2_count:
                  type: integer
                  minimum: 0
                  description: Number of kids in group 2
                adults_count:
                  type: integer
                  minimum: 0
                  description: Number of adults
                kids_1_trials:
                  type: integer
                  minimum: 0
                  description: Number of trial kids in group 1
                kids_2_trials:
                  type: integer
                  minimum: 0
                  description: Number of trial kids in group 2
                adults_trials:
                  type: integer
                  minimum: 0
                  description: Number of trial adults
                new_kids_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of new kids who paid for kit and signed direct debit
                new_kids_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of new kids who signed direct debit without kit
                new_adults_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of new adults who paid for kit and signed direct debit
                new_adults_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of new adults who signed direct debit without kit
                returning_kids_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of returning kids who paid for kit and signed direct debit
                returning_kids_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of returning kids who signed direct debit without kit
                returning_adults_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of returning adults who paid for kit and signed direct debit
                returning_adults_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of returning adults who signed direct debit without kit
                total_cash_taken:
                  type: number
                  minimum: 0
                  description: Total cash taken (in pounds)
                signup_names:
                  type: string
                  nullable: true
                  description: Names of people who signed up
                helper_names:
                  type: string
                  nullable: true
                  description: Names of helpers
                incidents:
                  type: string
                  nullable: true
                  description: Any incidents that occurred
                general_notes:
                  type: string
                  nullable: true
                  description: General notes about the session
      responses:
        '201':
          description: Report created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  report:
                    $ref: '#/components/schemas/EndOfDayReport'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          description: Forbidden - User does not have access to this club
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '409':
          description: Conflict - Report already exists for this club and date
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
  /end-of-day-reports/{id}:
    get:
      summary: Get End of Day report details
      operationId: showEndOfDayReport
      tags:
        - End of Day Reports
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID of the report to retrieve
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EndOfDayReport'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          description: Forbidden - User is not authorized to view this report
        '404':
          description: Report not found
    put:
      summary: Update End of Day report
      operationId: updateEndOfDayReport
      tags:
        - End of Day Reports
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID of the report to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                club_id:
                  type: integer
                  description: ID of the club this report is for
                report_date:
                  type: string
                  format: date
                  description: Date of the report
                kids_1_count:
                  type: integer
                  minimum: 0
                  description: Number of kids in group 1
                kids_2_count:
                  type: integer
                  minimum: 0
                  description: Number of kids in group 2
                adults_count:
                  type: integer
                  minimum: 0
                  description: Number of adults
                kids_1_trials:
                  type: integer
                  minimum: 0
                  description: Number of trial kids in group 1
                kids_2_trials:
                  type: integer
                  minimum: 0
                  description: Number of trial kids in group 2
                adults_trials:
                  type: integer
                  minimum: 0
                  description: Number of trial adults
                new_kids_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of new kids who paid for kit and signed direct debit
                new_kids_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of new kids who signed direct debit without kit
                new_adults_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of new adults who paid for kit and signed direct debit
                new_adults_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of new adults who signed direct debit without kit
                returning_kids_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of returning kids who paid for kit and signed direct debit
                returning_kids_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of returning kids who signed direct debit without kit
                returning_adults_paid_kit_and_signed_dd_count:
                  type: integer
                  minimum: 0
                  description: Number of returning adults who paid for kit and signed direct debit
                returning_adults_signed_dd_no_kit_count:
                  type: integer
                  minimum: 0
                  description: Number of returning adults who signed direct debit without kit
                total_cash_taken:
                  type: number
                  minimum: 0
                  description: Total cash taken (in pounds)
                signup_names:
                  type: string
                  nullable: true
                  description: Names of people who signed up
                helper_names:
                  type: string
                  nullable: true
                  description: Names of helpers
                incidents:
                  type: string
                  nullable: true
                  description: Any incidents that occurred
                general_notes:
                  type: string
                  nullable: true
                  description: General notes about the session
      responses:
        '200':
          description: Report updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  report:
                    $ref: '#/components/schemas/EndOfDayReport'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          description: Forbidden - User is not authorized to update this report
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '404':
          description: Report not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '409':
          description: Conflict - Report already exists for this club and date combination
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
  /overtime-requests:
    get:
      summary: List overtime requests
      description: Get a list of overtime requests. Non-admin users can only see their own requests.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by status
          schema:
            type: string
            enum:
              - pending
              - approved
              - rejected
              - cancelled
        - name: type
          in: query
          description: Filter by request type
          schema:
            type: string
            enum:
              - one_time
              - recurring
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/OvertimeRequest'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
    post:
      summary: Create overtime request
      description: Create a new overtime request
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - type
              properties:
                type:
                  type: string
                  enum:
                    - one_time
                    - recurring
                  description: Type of overtime request
                start_date:
                  type: string
                  format: date
                  description: Start date (required for one-time requests)
                end_date:
                  type: string
                  format: date
                  description: End date (required for one-time requests)
                day_of_week:
                  type: string
                  enum:
                    - monday
                    - tuesday
                    - wednesday
                    - thursday
                    - friday
                    - saturday
                    - sunday
                  description: Day of week (required for recurring requests)
                duration_weeks:
                  type: integer
                  minimum: 1
                  maximum: 52
                  description: Duration in weeks (required for recurring requests)
                preferred_club_id:
                  type: integer
                  description: ID of preferred club (optional)
                time_preference:
                  type: string
                  enum:
                    - morning
                    - afternoon
                    - evening
                  description: Preferred time of day (optional)
                notes:
                  type: string
                  maxLength: 1000
                  description: Additional notes (optional)
      responses:
        '201':
          description: Overtime request created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/OvertimeRequest'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/ValidationError'
  /overtime-requests/summary:
    get:
      summary: Get overtime requests summary
      description: Get a summary of overtime requests statistics. Non-admin users see only their own statistics.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                    description: Total number of overtime requests
                  pending:
                    type: integer
                    description: Number of pending requests
                  approved:
                    type: integer
                    description: Number of approved requests
                  rejected:
                    type: integer
                    description: Number of rejected requests
                  cancelled:
                    type: integer
                    description: Number of cancelled requests
                  one_time:
                    type: integer
                    description: Number of one-time requests
                  recurring:
                    type: integer
                    description: Number of recurring requests
        '401':
          $ref: '#/components/responses/Unauthorized'
  /overtime-requests/{id}:
    get:
      summary: Get overtime request details
      description: Get details of a specific overtime request. Non-admin users can only view their own requests.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Overtime request ID
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/OvertimeRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      summary: Update overtime request
      description: Update a pending overtime request. Non-admin users can only update their own requests.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Overtime request ID
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - one_time
                    - recurring
                start_date:
                  type: string
                  format: date
                end_date:
                  type: string
                  format: date
                day_of_week:
                  type: string
                  enum:
                    - monday
                    - tuesday
                    - wednesday
                    - thursday
                    - friday
                    - saturday
                    - sunday
                duration_weeks:
                  type: integer
                  minimum: 1
                  maximum: 52
                preferred_club_id:
                  type: integer
                time_preference:
                  type: string
                  enum:
                    - morning
                    - afternoon
                    - evening
                notes:
                  type: string
                  maxLength: 1000
      responses:
        '200':
          description: Overtime request updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/OvertimeRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
    delete:
      summary: Delete overtime request
      description: Delete a pending overtime request. Non-admin users can only delete their own requests.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Overtime request ID
          schema:
            type: integer
      responses:
        '200':
          description: Overtime request deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Overtime request deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
  /overtime-requests/{id}/cancel:
    post:
      summary: Cancel overtime request
      description: Cancel a pending overtime request. Non-admin users can only cancel their own requests.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Overtime request ID
          schema:
            type: integer
      responses:
        '200':
          description: Overtime request cancelled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/OvertimeRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
  /overtime-requests/{id}/approve:
    post:
      summary: Approve overtime request
      description: Approve a pending overtime request. Admin only.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Overtime request ID
          schema:
            type: integer
      responses:
        '200':
          description: Overtime request approved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/OvertimeRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
  /overtime-requests/{id}/reject:
    post:
      summary: Reject overtime request
      description: Reject a pending overtime request. Admin only.
      tags:
        - Overtime Requests
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Overtime request ID
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 500
                  description: Reason for rejection (optional)
      responses:
        '200':
          description: Overtime request rejected successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/OvertimeRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/UnprocessableEntity'
  /users:
    get:
      summary: List users
      operationId: listUsers
      tags:
        - Users
      security:
        - BearerAuth: []
      parameters:
        - name: per_page
          in: query
          schema:
            type: integer
            default: 15
          description: Items per page
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /users/{id}:
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: User ID
    get:
      summary: Get user by ID
      operationId: getUserById
      tags:
        - Users
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: User not found
  /api/clubs/summary:
    get:
      summary: Get clubs summary
      description: Returns a summary of all clubs with key health indicators
      operationId: getClubsSummary
      tags:
        - Club Metrics
      security:
        - coachBearerAuth: []
      parameters:
        - in: query
          name: date_range
          required: false
          schema:
            type: string
            enum:
              - today
              - yesterday
              - last_7_days
              - last_30_days
              - last_3_months
            default: last_30_days
          description: Date range for metrics calculation
      responses:
        '200':
          description: Successfully retrieved clubs summary
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    club_id:
                      type: integer
                      description: The club's ID
                    club_name:
                      type: string
                      description: The club's name
                    health_score:
                      type: integer
                      minimum: 0
                      maximum: 100
                      description: Calculated health score representing overall club performance
                    key_metric:
                      type: object
                      properties:
                        label:
                          type: string
                          description: Metric name (e.g., "Enrollment", "No-Shows", "Bookings")
                        value:
                          type: string
                          description: Formatted value (e.g., "68.5%", "+12%")
                        trend:
                          type: string
                          enum:
                            - up
                            - down
                            - stable
                          description: Trend direction
        '403':
          description: Unauthorized - Admin access required
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Admin access required.
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to fetch club metrics
                  error:
                    type: string
  /api/clubs/{id}/metrics:
    get:
      summary: Get club performance metrics
      description: Returns performance metrics for a specific club
      operationId: getClubMetrics
      tags:
        - Club Metrics
      security:
        - coachBearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: Club ID
        - in: query
          name: date_range
          required: true
          schema:
            type: string
            enum:
              - today
              - yesterday
              - last_7_days
              - last_30_days
              - last_3_months
          description: Date range for metrics calculation
      responses:
        '200':
          description: Successfully retrieved club metrics
          content:
            application/json:
              schema:
                type: object
                properties:
                  club_id:
                    type: integer
                    description: The club's ID
                  club_name:
                    type: string
                    description: The club's name
                  date_range:
                    type: string
                    description: The requested date range
                  period_start:
                    type: string
                    format: date-time
                    description: ISO timestamp of period start
                  period_end:
                    type: string
                    format: date-time
                    description: ISO timestamp of period end
                  bookings_count:
                    type: integer
                    description: Total number of trial bookings in the period
                  enrollment_rate:
                    type: number
                    format: float
                    minimum: 0
                    maximum: 100
                    description: Percentage of bookings that converted to enrollments
                  no_show_rate:
                    type: number
                    format: float
                    minimum: 0
                    maximum: 100
                    description: Percentage of bookings that were no-shows
                  attendance_rate:
                    type: number
                    format: float
                    minimum: 0
                    maximum: 100
                    description: Percentage of bookings that attended
                  new_students:
                    type: integer
                    description: Count of first-time trial students
                  returning_students:
                    type: integer
                    description: Count of returning trial students
                  total_revenue:
                    type: number
                    format: float
                    description: Total revenue in GBP
                  average_class_size:
                    type: number
                    format: float
                    description: Average number of students per class
                  bookings_change:
                    type: number
                    format: float
                    nullable: true
                    description: Percentage change from previous period
                  enrollment_change:
                    type: number
                    format: float
                    nullable: true
                    description: Percentage change from previous period
                  no_show_change:
                    type: number
                    format: float
                    nullable: true
                    description: Percentage change from previous period
                  attendance_change:
                    type: number
                    format: float
                    nullable: true
                    description: Percentage change from previous period
        '403':
          description: Unauthorized - Admin access required
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Admin access required.
        '404':
          description: Club not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Club not found
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The given data was invalid.
                  errors:
                    type: object
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to fetch club metrics
                  error:
                    type: string
  /api/clubs/{id}/facebook-ads:
    get:
      summary: Get Facebook advertising metrics
      description: Returns Facebook advertising performance for a specific club
      operationId: getFacebookAdsMetrics
      tags:
        - Club Metrics
      security:
        - coachBearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: Club ID
        - in: query
          name: date_range
          required: true
          schema:
            type: string
            enum:
              - today
              - yesterday
              - last_7_days
              - last_30_days
              - last_3_months
          description: Date range for metrics calculation
      responses:
        '200':
          description: Successfully retrieved Facebook ads metrics
          content:
            application/json:
              schema:
                type: object
                properties:
                  club_id:
                    type: integer
                    description: The club's ID
                  date_range:
                    type: string
                    description: The requested date range
                  period_start:
                    type: string
                    format: date-time
                    description: ISO timestamp of period start
                  period_end:
                    type: string
                    format: date-time
                    description: ISO timestamp of period end
                  total_spend:
                    type: number
                    format: float
                    description: Total advertising spend in GBP
                  impressions:
                    type: integer
                    description: Total number of ad impressions (currently returns 0)
                  clicks:
                    type: integer
                    description: Total number of clicks (currently returns 0)
                  ctr:
                    type: number
                    format: float
                    description: Click-through rate as percentage (currently returns 0)
                  cost_per_click:
                    type: number
                    format: float
                    nullable: true
                    description: Cost per click in GBP (currently returns null)
                  bookings_from_ads:
                    type: integer
                    description: Number of bookings attributed to Facebook ads
                  cost_per_booking:
                    type: number
                    format: float
                    nullable: true
                    description: Cost per booking in GBP
                  conversion_rate:
                    type: number
                    format: float
                    description: Percentage of clicks that became bookings (currently returns 0)
                  roas:
                    type: number
                    format: float
                    nullable: true
                    description: Return on ad spend ratio
                  campaigns:
                    type: array
                    description: Array of campaign objects (currently returns empty array)
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: Campaign identifier
                        name:
                          type: string
                          description: Campaign name
                        status:
                          type: string
                          enum:
                            - active
                            - paused
                            - completed
                          description: Campaign status
                        spend:
                          type: number
                          format: float
                          description: Campaign spend in GBP
                        impressions:
                          type: integer
                          description: Campaign impressions
                        clicks:
                          type: integer
                          description: Campaign clicks
                        conversions:
                          type: integer
                          description: Number of bookings from this campaign
        '403':
          description: Unauthorized - Admin access required
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Admin access required.
        '404':
          description: Club not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Club not found
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The given data was invalid.
                  errors:
                    type: object
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to fetch Facebook ads metrics
                  error:
                    type: string
  /v1/notifications:
    get:
      summary: Get list of notifications
      description: Returns a list of notifications for the authenticated user with pagination and filtering support. Supports efficient polling via Last-Modified headers.
      operationId: getNotifications
      tags:
        - Notifications
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: per_page
          in: query
          description: Number of items per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: filter
          in: query
          description: Filter notifications by read status
          schema:
            type: string
            enum:
              - all
              - read
              - unread
            default: all
        - name: If-Modified-Since
          in: header
          description: Client's last known modification timestamp for efficient polling
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Successful response with notifications list
          headers:
            Last-Modified:
              description: RFC 7231 timestamp of the most recent notification update
              schema:
                type: string
                format: date-time
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationListResponse'
        '304':
          description: Not Modified - no changes since the If-Modified-Since timestamp
        '401':
          description: Unauthorized - authentication required
        '422':
          description: Validation error
    post:
      summary: Create a new notification (Admin/Testing)
      description: Creates a new notification. This endpoint is primarily for admin use and testing purposes.
      operationId: createNotification
      tags:
        - Notifications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
                - type
                - priority
                - title
                - message
              properties:
                user_id:
                  type: integer
                  description: ID of the user to receive the notification
                type:
                  type: string
                  enum:
                    - system
                    - message
                    - reminder
                    - achievement
                    - warning
                    - info
                priority:
                  type: string
                  enum:
                    - low
                    - medium
                    - high
                title:
                  type: string
                  maxLength: 255
                message:
                  type: string
                action_url:
                  type: string
                  nullable: true
                  maxLength: 255
                action_label:
                  type: string
                  nullable: true
                  maxLength: 100
                metadata:
                  type: object
                  nullable: true
                avatar_url:
                  type: string
                  nullable: true
                  maxLength: 255
                sender_name:
                  type: string
                  nullable: true
                  maxLength: 100
      responses:
        '201':
          description: Notification created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Notification'
        '401':
          description: Unauthorized
        '422':
          description: Validation error
  /v1/notifications/unread-count:
    get:
      summary: Get unread notification count
      description: Lightweight endpoint to get just the count of unread notifications. Cached for 30 seconds for efficient polling.
      operationId: getUnreadNotificationCount
      tags:
        - Notifications
      responses:
        '200':
          description: Successful response with unread count
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - data
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    required:
                      - unreadCount
                    properties:
                      unreadCount:
                        type: integer
                        description: Number of unread notifications
                        example: 3
        '401':
          description: Unauthorized - authentication required
  /v1/notifications/{id}/read:
    patch:
      summary: Mark notification as read
      description: Marks a single notification as read and returns the updated notification
      operationId: markNotificationAsRead
      tags:
        - Notifications
      parameters:
        - name: id
          in: path
          required: true
          description: Notification ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Notification marked as read successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - data
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Notification'
        '401':
          description: Unauthorized
        '404':
          description: Notification not found
  /v1/notifications/mark-all-read:
    patch:
      summary: Mark all notifications as read
      description: Marks all unread notifications for the authenticated user as read
      operationId: markAllNotificationsAsRead
      tags:
        - Notifications
      responses:
        '200':
          description: All notifications marked as read successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - data
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    required:
                      - updated
                    properties:
                      updated:
                        type: integer
                        description: Number of notifications that were marked as read
                        example: 5
        '401':
          description: Unauthorized
  /v1/notifications/{id}:
    delete:
      summary: Delete a notification
      description: Deletes a single notification permanently
      operationId: deleteNotification
      tags:
        - Notifications
      parameters:
        - name: id
          in: path
          required: true
          description: Notification ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Notification deleted successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - message
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Notification deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Notification not found
  /push-notifications/register:
    post:
      summary: Register a push notification token
      description: Register an Expo push notification token for the authenticated user
      tags:
        - Push Notifications
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  pattern: ^ExponentPushToken\[.+\]$
                  example: ExponentPushToken[xxxxxxxxxxxxxxxxxxxxxx]
                  description: The Expo push token from the mobile app
      responses:
        '200':
          description: Token registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Push token registered successfully
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  errors:
                    type: object
  /push-notifications/remove:
    post:
      summary: Remove a push notification token
      description: Remove an Expo push notification token for the authenticated user
      tags:
        - Push Notifications
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  example: ExponentPushToken[xxxxxxxxxxxxxxxxxxxxxx]
                  description: The Expo push token to remove
      responses:
        '200':
          description: Token removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Push token removed successfully
        '404':
          description: Token not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Push token not found
  /push-notifications/tokens:
    get:
      summary: Get all registered push tokens
      description: Retrieve all registered Expo push tokens for the authenticated user
      tags:
        - Push Notifications
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of registered tokens
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  tokens:
                    type: array
                    items:
                      type: string
                      example: ExponentPushToken[xxxxxxxxxxxxxxxxxxxxxx]
  /push-notifications/test:
    post:
      summary: Send a test push notification
      description: Send a test push notification to all registered devices for the authenticated user
      tags:
        - Push Notifications
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - body
              properties:
                title:
                  type: string
                  maxLength: 255
                  example: Test Notification
                  description: The notification title
                body:
                  type: string
                  example: This is a test notification
                  description: The notification body text
      responses:
        '200':
          description: Test notification sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Test notification sent successfully
                  tokens_count:
                    type: integer
                    example: 2
                    description: Number of tokens the notification was sent to
        '400':
          description: No tokens registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: No push tokens registered for this user
        '500':
          description: Failed to send notification
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Failed to send notification
                  error:
                    type: string
                    description: The error message
components:
  schemas:
    User:
      title: User
      type: object
      required:
        - id
        - email
      properties:
        id:
          type: integer
          description: Unique identifier for the given user.
        email:
          type: string
          format: email
        name:
          type: string
        phone_number:
          type: string
          nullable: true
        is_admin:
          type: boolean
          default: false
        class_time_ids:
          type: array
          items:
            type: integer
          description: Array of class_time IDs the coach is assigned to
        email_verified_at:
          type: string
          format: date-time
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    EndOfDayReport:
      title: EndOfDayReport
      type: object
      properties:
        id:
          type: integer
        report_date:
          type: string
          format: date
        kids_1_count:
          type: integer
        kids_2_count:
          type: integer
        adults_count:
          type: integer
        kids_1_trials:
          type: integer
        kids_2_trials:
          type: integer
        adults_trials:
          type: integer
        new_kids_paid_kit_and_signed_dd_count:
          type: integer
        new_kids_signed_dd_no_kit_count:
          type: integer
        new_adults_paid_kit_and_signed_dd_count:
          type: integer
        new_adults_signed_dd_no_kit_count:
          type: integer
        returning_kids_paid_kit_and_signed_dd_count:
          type: integer
        returning_kids_signed_dd_no_kit_count:
          type: integer
        returning_adults_paid_kit_and_signed_dd_count:
          type: integer
        returning_adults_signed_dd_no_kit_count:
          type: integer
        total_cash_taken:
          type: number
          format: float
        signup_names:
          type: string
          nullable: true
        helper_names:
          type: string
          nullable: true
        incidents:
          type: string
          nullable: true
        general_notes:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        club:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
        user:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
        coach:
          type: object
          description: Alias for user, kept for backward compatibility
          properties:
            id:
              type: integer
            name:
              type: string
    Club:
      title: Club
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: integer
          description: Unique identifier for the club
        name:
          type: string
          description: Club name
        slug:
          type: string
          description: URL-friendly club identifier
        address:
          type: string
          description: Physical address of the club
        postcode:
          type: string
          description: Postal code
        latitude:
          type: number
          format: float
          nullable: true
          description: GPS latitude coordinate
        longitude:
          type: number
          format: float
          nullable: true
          description: GPS longitude coordinate
        class_times:
          type: array
          items:
            $ref: '#/components/schemas/ClassTime'
          description: List of class times at this club (only included when specifically loaded)
    ClassTime:
      title: ClassTime
      type: object
      required:
        - id
        - club_id
        - day
      properties:
        id:
          type: integer
          description: Unique identifier for the class time
        club_id:
          type: integer
          description: ID of the club this class belongs to
        day:
          type: string
          enum:
            - Monday
            - Tuesday
            - Wednesday
            - Thursday
            - Friday
            - Saturday
            - Sunday
          description: Day of the week
        name:
          type: string
          description: Name of the class (e.g., "Kids 1", "Adults")
        start_time:
          type: string
          format: time
          description: Class start time (HH:MM:SS)
        end_time:
          type: string
          format: time
          description: Class end time (HH:MM:SS)
        coaches:
          type: string
          description: Comma-separated list of coach names assigned to this class (excludes admin users)
          example: John Smith, Jane Doe
        helpers:
          type: array
          items:
            type: string
          description: List of helper names assigned to this class
          example:
            - Mike Wilson
            - Sarah Johnson
        todays_booking_count:
          type: integer
          description: Number of bookings scheduled for this class time today (excludes cancelled bookings)
          example: 15
    Booking:
      title: Booking
      type: object
      required:
        - id
        - names
        - start_time
      properties:
        id:
          type: integer
          description: Unique identifier for the booking
        uuid:
          type: string
          format: uuid
          description: UUID for the booking
        names:
          type: string
          description: Name(s) of the person(s) in the booking
        email:
          type: string
          format: email
          description: Contact email for the booking
        phone:
          type: string
          description: Contact phone number
        status:
          type: string
          enum:
            - pending
            - paid_dd
            - paid_awaiting_dd
            - unpaid_dd
            - unpaid_coach_call
            - not_joining
          default: pending
          description: Conversion status of the booking (for trial conversion tracking)
        attendance_status:
          type: string
          enum:
            - scheduled
            - completed
            - no-show
            - cancelled
          nullable: true
          description: Attendance status for the booking
        start_time:
          type: string
          format: date-time
          description: Scheduled start time of the booking
        cancelled_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when booking was cancelled
        checked_in_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when booking was marked as completed/checked-in
        no_show_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when booking was marked as no-show
        no_show:
          type: boolean
          default: false
          description: Whether the booking was a no-show
        channel:
          type: string
          enum:
            - Cadence
            - Website
          description: Booking source channel
        channel_display_name:
          type: string
          description: Display name for the channel with additional details
        source:
          type: string
          description: Display name for the booking source
        referrer_type:
          type: string
          nullable: true
          description: Type of traffic source/referrer
          enum:
            - GOOGLE_PAID
            - GOOGLE_ORGANIC
            - FACEBOOK_PAID
            - FACEBOOK_ORGANIC
            - INSTAGRAM_PAID
            - INSTAGRAM_ORGANIC
            - WEB_DIRECT
        class_time:
          $ref: '#/components/schemas/ClassTime'
          description: Associated class time (when loaded)
        club:
          $ref: '#/components/schemas/Club'
          description: Associated club (when loaded via class time)
    BookingStatistics:
      type: object
      properties:
        total:
          type: integer
          example: 50
        converted:
          type: integer
          example: 30
        pending:
          type: integer
          example: 15
        not_joining:
          type: integer
          example: 5
        conversion_rate:
          type: number
          format: float
          example: 60
        by_status:
          type: object
          properties:
            paid_dd:
              type: integer
              example: 20
            paid_awaiting_dd:
              type: integer
              example: 10
            unpaid_dd:
              type: integer
              example: 0
            unpaid_coach_call:
              type: integer
              example: 15
            not_joining:
              type: integer
              example: 5
    KitOrder:
      type: object
      properties:
        id:
          type: integer
          example: 1
        booking_id:
          type: integer
          nullable: true
          example: 123
          description: Optional booking ID if this kit order is linked to a booking
        student_name:
          type: string
          nullable: true
          example: John Smith
          description: Student name for standalone kit orders (when no booking_id)
        contact_email:
          type: string
          nullable: true
          format: email
          example: john@example.com
          description: Contact email for standalone kit orders
        contact_phone:
          type: string
          nullable: true
          example: '+447900123456'
          description: Contact phone for standalone kit orders
        items:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
                example: tshirt
              size:
                type: string
                example: medium youth
        notes:
          type: string
          nullable: true
          example: Please order extra large for growth
          description: Optional notes about the kit order
        created_at:
          type: string
          format: date-time
          example: '2025-01-15T10:00:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2025-01-15T10:00:00Z'
    Reminder:
      type: object
      properties:
        id:
          type: integer
          example: 1
        title:
          type: string
          example: Call John about trial
        description:
          type: string
          nullable: true
          example: 'Phone: 0411 123 456'
        reminder_time:
          type: string
          format: date-time
          example: '2025-01-20T10:00:00Z'
        priority:
          type: string
          enum:
            - low
            - medium
            - high
            - urgent
          example: high
        status:
          type: string
          enum:
            - pending
            - completed
            - snoozed
            - cancelled
          example: pending
        booking_id:
          type: integer
          nullable: true
          example: 123
        user_id:
          type: integer
          example: 5
        created_by:
          type: integer
          nullable: true
          example: 1
        snooze_until:
          type: string
          format: date-time
          nullable: true
          example: '2025-01-20T15:00:00Z'
        is_overdue:
          type: boolean
          example: false
        is_today:
          type: boolean
          example: true
        booking:
          $ref: '#/components/schemas/Booking'
          nullable: true
        user:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
            email:
              type: string
          nullable: true
        creator:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
          nullable: true
        created_at:
          type: string
          format: date-time
          example: '2025-01-15T10:00:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2025-01-15T10:00:00Z'
    Notification:
      type: object
      required:
        - id
        - userId
        - type
        - priority
        - title
        - message
        - timestamp
        - read
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the notification
          example: 550e8400-e29b-41d4-a716-446655440000
        userId:
          type: string
          description: ID of the user this notification belongs to
          example: '1'
        type:
          type: string
          enum:
            - system
            - message
            - reminder
            - achievement
            - warning
            - info
          description: Type of notification
          example: message
        priority:
          type: string
          enum:
            - low
            - medium
            - high
          description: Priority level of the notification
          example: medium
        title:
          type: string
          description: Title of the notification
          example: New Message
        message:
          type: string
          description: Main content of the notification
          example: You have received a new message from your coach
        timestamp:
          type: string
          format: date-time
          description: ISO 8601 timestamp when the notification was created
          example: '2025-09-19T10:30:00Z'
        read:
          type: boolean
          description: Whether the notification has been read
          example: false
        readAt:
          type: string
          format: date-time
          nullable: true
          description: ISO 8601 timestamp when the notification was marked as read
          example: '2025-09-19T11:00:00Z'
        actionUrl:
          type: string
          nullable: true
          description: Optional URL for an action associated with this notification
          example: https://example.com/messages/123
        actionLabel:
          type: string
          nullable: true
          description: Label for the action button
          example: View Message
        metadata:
          type: object
          nullable: true
          additionalProperties: true
          description: Additional data associated with the notification
          example:
            source: system
            reference_id: msg_123
        avatarUrl:
          type: string
          nullable: true
          description: URL to an avatar image for the notification sender
          example: https://example.com/avatars/coach123.jpg
        senderName:
          type: string
          nullable: true
          description: Name of the notification sender
          example: John Coach
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 timestamp when the notification was created
          example: '2025-09-19T10:30:00Z'
    NotificationListResponse:
      type: object
      required:
        - success
        - data
      properties:
        success:
          type: boolean
          description: Whether the request was successful
          example: true
        data:
          type: object
          required:
            - notifications
            - unreadCount
          properties:
            notifications:
              type: array
              items:
                $ref: '#/components/schemas/Notification'
              description: List of notifications
            unreadCount:
              type: integer
              description: Total count of unread notifications
              example: 5
            lastModified:
              type: string
              format: date-time
              nullable: true
              description: ISO 8601 timestamp of the most recent notification update
              example: '2025-09-19T12:00:00Z'
        meta:
          type: object
          properties:
            current_page:
              type: integer
              description: Current page number
              example: 1
            per_page:
              type: integer
              description: Number of items per page
              example: 20
            total:
              type: integer
              description: Total number of notifications (capped at 100)
              example: 45
    ClubLite:
      type: object
      properties:
        id:
          type: integer
          description: The unique identifier for the club
          example: 1
        name:
          type: string
          description: The name of the club
          example: Temple Manchester - City Center
        slug:
          type: string
          description: The URL-friendly slug for the club
          example: city-center
        address:
          type: string
          description: The street address of the club
          example: 123 Main St
        postcode:
          type: string
          description: The postal code of the club
          example: M1 1AA
        latitude:
          type: number
          format: double
          description: The latitude coordinate of the club location
          example: 53.4808
        longitude:
          type: number
          format: double
          description: The longitude coordinate of the club location
          example: -2.2426
      required:
        - id
        - name
        - slug
    ValidationError:
      description: Validation Error - Invalid input data
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: General error message
              errors:
                type: object
                description: Field-specific validation errors
                additionalProperties:
                  type: array
                  items:
                    type: string
          example:
            message: The given data was invalid.
            errors:
              email:
                - The email field is required.
              password:
                - The password field must be at least 8 characters.
    Kit:
      type: object
      required:
        - id
        - type
        - name
        - price
      properties:
        id:
          type: integer
          description: Unique identifier for the kit item
          example: 1
        type:
          type: string
          description: Type of kit item
          enum:
            - tshirt
            - trousers
            - gloves
            - shinpads
            - kitbag
          example: tshirt
        name:
          type: string
          description: Display name of the kit item
          example: T-Shirt
        sizes:
          type: array
          items:
            type: string
          description: Available sizes for this kit item
          example:
            - Small Youth
            - Medium Youth
            - Large Youth
            - Small
            - Medium
            - Large
            - XL
            - 2XL
        price:
          type: number
          format: float
          description: Price of the kit item in GBP
          example: 25
        description:
          type: string
          description: Detailed description of the kit item
          example: Temple Manchester training t-shirt
        image_url:
          type: string
          nullable: true
          description: URL of the kit item image
          example: https://s3.amazonaws.com/your-bucket/kit-images/tshirt.jpg
    OvertimeRequest:
      type: object
      properties:
        id:
          type: integer
          description: Overtime request ID
        user:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
            email:
              type: string
              format: email
        type:
          type: string
          enum:
            - one_time
            - recurring
          description: Type of overtime request
        start_date:
          type: string
          format: date
          nullable: true
          description: Start date for one-time requests
        end_date:
          type: string
          format: date
          nullable: true
          description: End date for one-time requests
        day_of_week:
          type: string
          enum:
            - monday
            - tuesday
            - wednesday
            - thursday
            - friday
            - saturday
            - sunday
          nullable: true
          description: Day of week for recurring requests
        duration_weeks:
          type: integer
          nullable: true
          description: Duration in weeks for recurring requests
        preferred_club:
          type: object
          nullable: true
          properties:
            id:
              type: integer
            name:
              type: string
        time_preference:
          type: string
          enum:
            - morning
            - afternoon
            - evening
          nullable: true
          description: Preferred time of day
        notes:
          type: string
          nullable: true
          description: Additional notes
        status:
          type: string
          enum:
            - pending
            - approved
            - rejected
            - cancelled
          description: Request status
        approved_by:
          type: object
          nullable: true
          properties:
            id:
              type: integer
            name:
              type: string
        approved_at:
          type: string
          format: date-time
          nullable: true
        rejection_reason:
          type: string
          nullable: true
          description: Reason for rejection
        can_be_edited:
          type: boolean
          description: Whether the request can be edited
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PaginationMeta:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        from:
          type: integer
          example: 1
        last_page:
          type: integer
          example: 5
        per_page:
          type: integer
          example: 20
        to:
          type: integer
          example: 20
        total:
          type: integer
          example: 100
        path:
          type: string
          example: /api/overtime-requests
        links:
          type: array
          items:
            type: object
            properties:
              url:
                type: string
                nullable: true
              label:
                type: string
              active:
                type: boolean
  responses:
    LoginSuccessResponse:
      description: A successful login response
      content:
        application/json:
          schema:
            type: object
            required:
              - token
              - user
              - expires_at
            properties:
              token:
                type: string
                description: Bearer token for authentication
              user:
                $ref: '#/components/schemas/User'
              expires_at:
                type: string
                format: date-time
                description: Token expiration timestamp
          example:
            token: mPDZsV6SK8ln3RLtsQkvEESeCSIWOaEfP0ldk19EVDGWfpcAzY3fyLLNiNzUJeh9
            user:
              id: 1
              name: John Doe
              email: john@example.com
              is_admin: false
              class_time_ids:
                - 1
                - 2
                - 3
            expires_at: '2025-09-06T12:33:38+00:00'
    UnauthorizedError:
      description: Unauthorized - Invalid or missing authentication token
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: Error message
          examples:
            no_token:
              value:
                message: Unauthorized - No token provided
            invalid_token:
              value:
                message: Unauthorized - Invalid or expired token
    ValidationError:
      description: Validation Error - Invalid input data
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: General error message
              errors:
                type: object
                description: Field-specific validation errors
                additionalProperties:
                  type: array
                  items:
                    type: string
          example:
            message: The given data was invalid.
            errors:
              email:
                - The email field is required.
              password:
                - The password field must be at least 8 characters.
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Unauthenticated.
            required:
              - message
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Bad request
              errors:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: This action is unauthorized.
    NotFound:
      description: Not Found
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Resource not found
    UnprocessableEntity:
      description: Unprocessable Entity
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: The given data was invalid.
              errors:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: Bearer token authentication using CoachToken
    AdminApiKey:
      type: apiKey
      in: header
      name: X-Admin-API-Key
      description: Admin API key authentication
